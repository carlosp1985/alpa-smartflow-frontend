<div ng-controller="FacturacionController">

   <div class="row" ng-if="venta">
      <div class="col s12">
         <h4 class="page-title">Facturación electrónica - Venta #{{venta.id}}</h4>
         <p class="page-subtitle">Cliente: {{(venta.cliente && venta.cliente.nombre) || 'Consumidor final'}}</p>
      </div>
   </div>

   <div class="row">
      <div class="col s12 m6" ng-if="venta">
         <ul class="collection with-header">
            <li class="collection-header"><h5>Datos de la venta</h5></li>
            <li class="collection-item">
               <span>Total neto</span>
               <span class="secondary-content">{{venta.total_neto | currency:'$':0}}</span>
            </li>
            <li class="collection-item">
               <span>Fecha</span>
               <span class="secondary-content">{{venta.fecha | date:'yyyy-MM-dd HH:mm'}}</span>
            </li>
            <li class="collection-item">
               <span>Estado de la venta</span>
               <span class="secondary-content">{{venta.estado}}</span>
            </li>
         </ul>
      </div>

      <div class="col s12 m6">
         <ul class="collection with-header">
            <li class="collection-header"><h5>Factura electrónica</h5></li>
            <li class="collection-item" ng-if="!facturacion">
               <p class="grey-text">Esta venta aún no tiene factura electrónica generada.</p>
               <div class="input-field">
                  <input id="email_receptor" type="email" ng-model="email_receptor">
                  <label for="email_receptor">Correo electrónico del receptor (opcional)</label>
               </div>
               <div class="right-align" style="margin-top: 10px;">
                  <a class="btn waves-effect waves-light green" ng-click="generarFactura()">
                     Generar factura electrónica
                     <i class="material-icons right">send</i>
                  </a>
               </div>
            </li>
            <li class="collection-item" ng-if="facturacion">
               <p><strong>Estado:</strong> {{facturacion.estado || 'GENERADA'}}</p>
               <p ng-if="facturacion.numero"><strong>Número:</strong> {{facturacion.numero}}</p>
               <p ng-if="facturacion.cufe || facturacion.cufe_uuid"><strong>CUFE:</strong> {{facturacion.cufe || facturacion.cufe_uuid}}</p>
               <p ng-if="facturacion.fecha_envio"><strong>Fecha de envío:</strong> {{facturacion.fecha_envio | date:'yyyy-MM-dd HH:mm'}}</p>
               <p ng-if="facturacion.mensaje_error" class="red-text"><strong>Error:</strong> {{facturacion.mensaje_error}}</p>
            </li>
         </ul>
      </div>
   </div>

   <div class="row">
      <div class="col s12 right-align" style="margin-top: 20px;">
         <a class="btn-flat" ng-click="volver()">Volver al detalle de venta</a>
      </div>
   </div>

</div>
